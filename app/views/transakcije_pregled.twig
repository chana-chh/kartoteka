{% extends "templates/app.twig" %}
{% block sadrzaj %}
<h1 class="uk-text-danger">
  Transakcije za karton
  <small><em class="uk-text-primary">[{{ karton.broj() }}]</em></small>
</h1>
<div class="uk-panel uk-background-muted uk-padding-small">
  <div class="uk-clearfix">
    <div class="uk-float-left">
      <div class="uk-button-group">
        <button onclick="window.history.back();" class="uk-button uk-button-primary uk-button-small">
          <span uk-icon="chevron-left"></span> Nazad
        </button>
        <a href="{{ path_for('kartoni.pregled', { id: karton.id }) }}"
          class="uk-button uk-button-primary uk-button-small">
          <span uk-icon="chevron-double-left"></span> Otvori karton
        </a>
      </div>
    </div>
    <div class="uk-float-right">
      <div class="uk-button-group">
        <a href="" class="uk-button uk-button-secondary uk-button-small">
          <span uk-icon="database"></span> Razduzivanje
        </a>
        <a href="" class="uk-button uk-button-primary uk-button-small">
          <span uk-icon="bookmark"></span> Zaduzi taksu
        </a>
        <a href="" class="uk-button uk-button-primary uk-button-small">
          <span uk-icon="bookmark"></span> Zaduzi zakup
        </a>
        <a href="{{ path_for('racun', { id: karton.id }) }}" class="uk-button uk-button-primary uk-button-small">
          <span uk-icon="bookmark"></span> Zaduzi racun
        </a>
        <a href="" class="uk-button uk-button-danger uk-button-small">
          <span uk-icon="refresh"></span> Reprogrami
        </a>
      </div>
    </div>
  </div>
</div>

<div class="uk-width-1-1 uk-margin-top">
  <ul uk-accordion>
    <li>
      <a class="uk-accordion-title" href="#">
        <h2>
          Takse
          <em class="uk-text-success">[{{ karton.takse()|length }}]</em>
          <em class="uk-text-danger">[{{ karton.nerazduzeneTakse()|length }}]</em>
        </h2>
      </a>
      <div class="uk-accordion-content">
        <hr />
        <div class="uk-overflow-auto">
          <table class="uk-table uk-table-divider uk-table-striped uk-table-hover uk-table-small">
            <thead>
              <tr>
                <th class="w-25">Godina</th>
                <th class="w-25 uk-text-right">Iznos</th>
                <th class="w-25 uk-text-center">Razduzeno</th>
                <th class="w-25">Reprogram</th>
              </tr>
            </thead>
            <tbody>
              {% for taksa in karton.takse() %}
              <tr>
                <td>{{ taksa.godina }}</td>
                <td class="uk-text-right">
                  {{ taksa.iznos|number_format(2, '.', ',') }}
                </td>
                <td class="uk-text-center">{{ taksa.razduzenoDisabled() | raw }}</td>
                <td class="uk-text-primary">
                  {% if taksa.reprogram_id %}
                  <span uk-icon="refresh"></span> reprogram
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </li>
    <li>
      <a class="uk-accordion-title" href="#">
        <h2>
          Zakup
          <em class="uk-text-success">[{{ karton.zakupi()|length }}]</em>
          <em class="uk-text-danger">[{{ karton.nerazduzeniZakupi()|length }}]</em>
        </h2>
      </a>
      <div class="uk-accordion-content">
        <hr>
        <div class="uk-overflow-auto">
          <table class="uk-table uk-table-divider uk-table-striped uk-table-hover uk-table-small">
            <thead>
              <tr>
                <th class="w-25">Godina</th>
                <th class="w-25 uk-text-right">Iznos</th>
                <th class="w-25 uk-text-center">Razduzeno</th>
                <th class="w-25">Reprogram</th>
              </tr>
            </thead>
            <tbody>
              {% for zakup in karton.zakupi() %}
              <tr>
                <td>{{ zakup.godina }}</td>
                <td class="uk-text-right">
                  {{ zakup.iznos|number_format(2, '.', ',') }}
                </td>
                <td class="uk-text-center">{{ zakup.razduzenoDisabled() | raw }}</td>
                <td class="uk-text-primary">
                  {% if zakup.reprogram_id %}
                  <span uk-icon="refresh"></span> reprogram
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </li>
    <li>
      <a class="uk-accordion-title" href="#">
        <h2>
          Raƒçuni
          <em class="uk-text-success">[{{ karton.racuni()|length }}]</em>
          <em class="uk-text-danger">[{{ karton.nerazduzeniRacuni()|length }}]</em>
        </h2>
      </a>
      <div class="uk-accordion-content">
        <hr />
        <div class="uk-overflow-auto">
          <table class="uk-table uk-table-divider uk-table-striped uk-table-hover uk-table-small">
            <thead>
              <tr>
                <th class="w-20">Broj</th>
                <th class="w-20">Datum</th>
                <th class="w-20 uk-text-right">Iznos</th>
                <th class="w-20 uk-text-center">Razduzeno</th>
                <th class="w-20">Reprogram</th>
              </tr>
            </thead>
            <tbody>
              {% for rn in karton.racuni() %}
              <tr>
                <td>{{ rn.broj }}</td>
                <td>{{ rn.datum() }}</td>
                <td class="uk-text-right">
                  {{ rn.iznos|number_format(2, '.', ',') }}
                </td>
                <td class="uk-text-center">{{ rn.razduzenoDisabled() | raw }}</td>
                <td class="uk-text-primary">
                  {% if rn.reprogram_id %}
                  <span uk-icon="refresh"></span> reprogram
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </li>
    <li>
      <a class="uk-accordion-title" href="#">
        <h2>
          Reprogrami
          <em class="uk-text-success">[0]</em>
        </h2>
      </a>
      <div class="uk-accordion-content">
        <hr />
        <p>Tabela sa zaduzenjima za reprogram.</p>
      </div>
    </li>
  </ul>
</div>
{% endblock sadrzaj %}

{% block traka %}
<div uk-grid>
  <div class="uk-width-1-2">
    <h2 class="uk-text-right">Saldo kartona</h2>
    <div class="uk-panel uk-background-muted uk-padding-small uk-text-large uk-text-bold uk-text-right">
      <h1 class="uk-text-success" id="saldo">
        {{ karton.saldo | number_format(2, '.', ',') }}
      </h1>
    </div>
  </div>
  <div class="uk-width-1-2">
    <h2 class="uk-text-right">Ukupan dug</h2>
    <div class="uk-panel uk-background-muted uk-padding-small uk-text-large uk-text-bold uk-text-right">
      <h1 class="uk-text-danger" id="ukupan-dug">
        {% set dug = karton.dugZaTakse() + karton.dugZaZakupe() + karton.dugZaRacune() %}
        {{ dug | number_format(2, '.', ',') }}
      </h1>
    </div>
  </div>
  <div class="uk-width-1-2">
    <h2>Dug za takse</h2>
  </div>
  <div class="uk-width-1-2">
    <div class="uk-panel uk-background-muted uk-text-large uk-text-bold uk-text-right">
      <h2 class="uk-text-danger" id="takse-dug">
        {{ karton.dugZaTakse() | number_format(2, '.', ',') }}
      </h2>
    </div>
  </div>
  <div class="uk-width-1-2">
    <h2>Dug za zakup</h2>
  </div>
  <div class="uk-width-1-2">
    <div class="uk-panel uk-background-muted uk-text-large uk-text-bold uk-text-right">
      <h2 class="uk-text-danger" id="takse-dug">
        {{ karton.dugZaZakupe() | number_format(2, '.', ',') }}
      </h2>
    </div>
  </div>
  <div class="uk-width-1-2">
    <h2>Dug za racune</h2>
  </div>
  <div class="uk-width-1-2">
    <div class="uk-panel uk-background-muted uk-text-large uk-text-bold uk-text-right">
      <h2 class="uk-text-danger" id="takse-dug">
        {{ karton.dugZaRacune() | number_format(2, '.', ',') }}
      </h2>
    </div>
  </div>
</div>
<hr />
<h2>Uputstvo</h2>
<p>
  Odabrati (cekirati) zaduzenja koja ce se razduziti. Ukupan iznos odabranih
  razduzenja ce se pojaviti u polju "Iznos razduzenja". Uneti iznos i datum
  uplate. Kliknuti na dugme "Snimi uplatu i razduzi odabrane stavke".
</p>
<p>
  Izabrane stavke ce biti razduzene, a uplata snimljena.
</p>
{% endblock traka %}
